@{
    ViewData["Title"] = "揪IN｜差你一個，立刻開鍋";
}

<style>
    .danger-wrap {
        max-width: 680px;
        margin: 0 auto;
    }

    .danger-title {
        font-size: 2.2rem;
        font-weight: 800;
        line-height: 1.15;
    }

        .danger-title span {
            color: #dc2626;
        }

    .countdown {
        font-size: 2.6rem;
        font-weight: 800;
        letter-spacing: 0.05em;
    }

        .countdown.warn {
            color: #ea580c;
        }

        .countdown.danger {
            color: #dc2626;
            animation: shake 0.25s infinite alternate;
        }

    @@keyframes shake {
        from

    {
        transform: translateX(-2px);
    }

    to {
        transform: translateX(2px);
    }

    }

    .progress-box {
        background: #f9fafb;
        border-radius: 1.2rem;
        padding: 1.5rem;
        box-shadow: 0 10px 26px rgba(0,0,0,.08);
    }

    .big-progress {
        height: 16px;
        border-radius: 999px;
        background: #e5e7eb;
        overflow: hidden;
    }

    .big-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #22c55e, #16a34a);
        transition: width .4s ease-out;
    }

    .action-btn {
        font-size: 1.2rem;
        font-weight: 800;
        padding: 1rem 1.5rem;
        border-radius: 999px;
        box-shadow: 0 16px 36px rgba(220,38,38,.45);
        animation: pulse 1.6s infinite;
    }

    @@keyframes pulse {
        0%

    {
        transform: scale(1);
    }

    50% {
        transform: scale(1.04);
    }

    100% {
        transform: scale(1);
    }

    }

    .guilt-text {
        font-size: .9rem;
        color: #6b7280;
        margin-top: .5rem;
    }
</style>

<div id="app" class="container py-5">

    <div class="danger-wrap text-center">

        <!-- ① 主標 -->
        <h1 class="danger-title mb-3">
            差你一個，<span>立刻開鍋</span>
        </h1>

        <p class="text-muted mb-4">
            你不進來，這團就不動
        </p>

        <!-- ② 倒數 -->
        <div class="mb-4">
            <div class="text-muted small mb-1">
                剩餘時間
            </div>
            <div class="countdown"
                 :class="countdownClass">
                {{ remainText }}
            </div>
        </div>

        <!-- ③ 進度壓力 -->
        <div class="progress-box mb-4">
            <div class="mb-2 fw-bold">
                已有 {{ currentPeople }} / {{ targetPeople }} 人
            </div>

            <div class="big-progress mb-2">
                <div class="big-progress-bar"
                     :style="{ width: percent + '%' }">
                </div>
            </div>

            <div class="text-danger fw-bold">
                就差你一個
            </div>
        </div>

        <!-- ④ 唯一行動 -->
        <button class="btn btn-danger action-btn w-100"
                @@click ="joinNow">
            我來補最後一格
        </button>

        <div class="guilt-text">
            點了不一定送，<br />
            <strong>但你不點，一定不送</strong>
        </div>
    </div>

</div>

<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

<script>
    const { createApp } = Vue;

    createApp({
        data() {
            return {
                deadline: new Date(Date.now() + 8 * 60 * 1000), // demo：8 分鐘
                now: new Date(),
                currentPeople: 4,
                targetPeople: 5
            };
        },
        computed: {
            remainSeconds() {
                const diff = this.deadline - this.now;
                return Math.max(Math.floor(diff / 1000), 0);
            },
            remainText() {
                const m = Math.floor(this.remainSeconds / 60);
                const s = this.remainSeconds % 60;
                return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            },
            percent() {
                return Math.min(
                    Math.round(this.currentPeople * 100 / this.targetPeople),
                    100
                );
            },
            countdownClass() {
                if (this.remainSeconds <= 300) return 'danger';
                if (this.remainSeconds <= 900) return 'warn';
                return '';
            }
        },
        methods: {
            joinNow() {
                alert('你已經 IN 了，去拉下一個人');
                // 這裡之後接 API 下單
            }
        },
        mounted() {
            setInterval(() => {
                this.now = new Date();
            }, 1000);
        }
    }).mount('#app');
</script>
